function cov_la3h57dik(){var path="/Users/tansuyin/Desktop/group-d/helper/index.js";var hash="ca7520a3f5061baaa0eca8182b319b108c67d013";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/tansuyin/Desktop/group-d/helper/index.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:40}},"1":{start:{line:2,column:14},end:{line:2,column:40}},"2":{start:{line:3,column:13},end:{line:3,column:38}},"3":{start:{line:4,column:21},end:{line:4,column:54}},"4":{start:{line:6,column:13},end:{line:6,column:28}},"5":{start:{line:9,column:16},end:{line:9,column:18}},"6":{start:{line:11,column:0},end:{line:21,column:1}},"7":{start:{line:12,column:4},end:{line:20,column:6}},"8":{start:{line:13,column:8},end:{line:19,column:10}},"9":{start:{line:14,column:12},end:{line:18,column:13}},"10":{start:{line:15,column:16},end:{line:15,column:34}},"11":{start:{line:17,column:16},end:{line:17,column:60}},"12":{start:{line:17,column:50},end:{line:17,column:58}},"13":{start:{line:23,column:0},end:{line:33,column:1}},"14":{start:{line:24,column:4},end:{line:32,column:6}},"15":{start:{line:25,column:8},end:{line:31,column:10}},"16":{start:{line:26,column:12},end:{line:30,column:13}},"17":{start:{line:27,column:16},end:{line:27,column:34}},"18":{start:{line:29,column:16},end:{line:29,column:62}},"19":{start:{line:29,column:52},end:{line:29,column:60}},"20":{start:{line:36,column:0},end:{line:58,column:1}},"21":{start:{line:39,column:4},end:{line:57,column:6}},"22":{start:{line:40,column:17},end:{line:40,column:19}},"23":{start:{line:41,column:8},end:{line:56,column:10}},"24":{start:{line:42,column:12},end:{line:55,column:13}},"25":{start:{line:43,column:16},end:{line:43,column:27}},"26":{start:{line:45,column:16},end:{line:53,column:17}},"27":{start:{line:46,column:20},end:{line:52,column:21}},"28":{start:{line:51,column:28},end:{line:51,column:44}},"29":{start:{line:54,column:16},end:{line:54,column:27}},"30":{start:{line:61,column:0},end:{line:66,column:1}},"31":{start:{line:62,column:14},end:{line:62,column:16}},"32":{start:{line:63,column:4},end:{line:63,column:23}},"33":{start:{line:64,column:4},end:{line:64,column:23}},"34":{start:{line:65,column:4},end:{line:65,column:14}},"35":{start:{line:68,column:0},end:{line:84,column:1}},"36":{start:{line:69,column:4},end:{line:83,column:6}},"37":{start:{line:70,column:8},end:{line:82,column:10}},"38":{start:{line:71,column:12},end:{line:81,column:13}},"39":{start:{line:72,column:16},end:{line:72,column:27}},"40":{start:{line:74,column:16},end:{line:80,column:17}},"41":{start:{line:75,column:36},end:{line:75,column:43}},"42":{start:{line:76,column:20},end:{line:79,column:21}},"43":{start:{line:77,column:39},end:{line:77,column:79}},"44":{start:{line:78,column:24},end:{line:78,column:39}},"45":{start:{line:87,column:0},end:{line:91,column:1}},"46":{start:{line:88,column:4},end:{line:88,column:21}},"47":{start:{line:89,column:4},end:{line:89,column:21}},"48":{start:{line:90,column:4},end:{line:90,column:14}},"49":{start:{line:93,column:0},end:{line:110,column:1}},"50":{start:{line:94,column:4},end:{line:109,column:6}},"51":{start:{line:95,column:8},end:{line:108,column:10}},"52":{start:{line:96,column:12},end:{line:107,column:13}},"53":{start:{line:97,column:16},end:{line:97,column:27}},"54":{start:{line:99,column:16},end:{line:106,column:18}},"55":{start:{line:100,column:20},end:{line:105,column:21}},"56":{start:{line:101,column:20},end:{line:101,column:31}},"57":{start:{line:103,column:39},end:{line:103,column:90}},"58":{start:{line:104,column:24},end:{line:104,column:39}},"59":{start:{line:112,column:0},end:{line:125,column:1}},"60":{start:{line:115,column:22},end:{line:115,column:40}},"61":{start:{line:117,column:20},end:{line:117,column:81}},"62":{start:{line:119,column:21},end:{line:119,column:50}},"63":{start:{line:120,column:4},end:{line:124,column:5}},"64":{start:{line:121,column:8},end:{line:121,column:29}},"65":{start:{line:123,column:8},end:{line:123,column:39}},"66":{start:{line:127,column:0},end:{line:129,column:1}},"67":{start:{line:128,column:4},end:{line:128,column:60}},"68":{start:{line:131,column:0},end:{line:133,column:1}},"69":{start:{line:132,column:4},end:{line:132,column:43}},"70":{start:{line:135,column:0},end:{line:145,column:1}},"71":{start:{line:136,column:4},end:{line:144,column:6}},"72":{start:{line:137,column:8},end:{line:143,column:8}},"73":{start:{line:138,column:8},end:{line:142,column:9}},"74":{start:{line:139,column:10},end:{line:139,column:21}},"75":{start:{line:141,column:10},end:{line:141,column:24}},"76":{start:{line:147,column:0},end:{line:147,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:24},end:{line:11,column:25}},loc:{start:{line:11,column:42},end:{line:21,column:1}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:23},end:{line:12,column:24}},loc:{start:{line:12,column:44},end:{line:20,column:5}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:13,column:55},end:{line:13,column:56}},loc:{start:{line:13,column:71},end:{line:19,column:9}},line:13},"3":{name:"(anonymous_3)",decl:{start:{line:17,column:40},end:{line:17,column:41}},loc:{start:{line:17,column:50},end:{line:17,column:58}},line:17},"4":{name:"(anonymous_4)",decl:{start:{line:23,column:26},end:{line:23,column:27}},loc:{start:{line:23,column:44},end:{line:33,column:1}},line:23},"5":{name:"(anonymous_5)",decl:{start:{line:24,column:23},end:{line:24,column:24}},loc:{start:{line:24,column:44},end:{line:32,column:5}},line:24},"6":{name:"(anonymous_6)",decl:{start:{line:25,column:57},end:{line:25,column:58}},loc:{start:{line:25,column:73},end:{line:31,column:9}},line:25},"7":{name:"(anonymous_7)",decl:{start:{line:29,column:42},end:{line:29,column:43}},loc:{start:{line:29,column:52},end:{line:29,column:60}},line:29},"8":{name:"(anonymous_8)",decl:{start:{line:36,column:24},end:{line:36,column:25}},loc:{start:{line:36,column:41},end:{line:58,column:1}},line:36},"9":{name:"(anonymous_9)",decl:{start:{line:39,column:23},end:{line:39,column:24}},loc:{start:{line:39,column:44},end:{line:57,column:5}},line:39},"10":{name:"(anonymous_10)",decl:{start:{line:41,column:81},end:{line:41,column:82}},loc:{start:{line:41,column:98},end:{line:56,column:9}},line:41},"11":{name:"(anonymous_11)",decl:{start:{line:61,column:25},end:{line:61,column:26}},loc:{start:{line:61,column:52},end:{line:66,column:1}},line:61},"12":{name:"(anonymous_12)",decl:{start:{line:68,column:21},end:{line:68,column:22}},loc:{start:{line:68,column:39},end:{line:84,column:1}},line:68},"13":{name:"(anonymous_13)",decl:{start:{line:69,column:23},end:{line:69,column:24}},loc:{start:{line:69,column:44},end:{line:83,column:5}},line:69},"14":{name:"(anonymous_14)",decl:{start:{line:70,column:36},end:{line:70,column:37}},loc:{start:{line:70,column:53},end:{line:82,column:9}},line:70},"15":{name:"(anonymous_15)",decl:{start:{line:87,column:25},end:{line:87,column:26}},loc:{start:{line:87,column:53},end:{line:91,column:1}},line:87},"16":{name:"(anonymous_16)",decl:{start:{line:93,column:29},end:{line:93,column:30}},loc:{start:{line:93,column:43},end:{line:110,column:1}},line:93},"17":{name:"(anonymous_17)",decl:{start:{line:94,column:23},end:{line:94,column:24}},loc:{start:{line:94,column:44},end:{line:109,column:5}},line:94},"18":{name:"(anonymous_18)",decl:{start:{line:95,column:34},end:{line:95,column:35}},loc:{start:{line:95,column:55},end:{line:108,column:9}},line:95},"19":{name:"(anonymous_19)",decl:{start:{line:99,column:42},end:{line:99,column:43}},loc:{start:{line:99,column:63},end:{line:106,column:17}},line:99},"20":{name:"(anonymous_20)",decl:{start:{line:112,column:26},end:{line:112,column:27}},loc:{start:{line:112,column:45},end:{line:125,column:1}},line:112},"21":{name:"(anonymous_21)",decl:{start:{line:127,column:24},end:{line:127,column:25}},loc:{start:{line:127,column:39},end:{line:129,column:1}},line:127},"22":{name:"(anonymous_22)",decl:{start:{line:131,column:27},end:{line:131,column:28}},loc:{start:{line:131,column:51},end:{line:133,column:1}},line:131},"23":{name:"(anonymous_23)",decl:{start:{line:135,column:21},end:{line:135,column:22}},loc:{start:{line:135,column:39},end:{line:145,column:1}},line:135},"24":{name:"(anonymous_24)",decl:{start:{line:136,column:23},end:{line:136,column:24}},loc:{start:{line:136,column:44},end:{line:144,column:5}},line:136},"25":{name:"(anonymous_25)",decl:{start:{line:137,column:80},end:{line:137,column:81}},loc:{start:{line:137,column:96},end:{line:143,column:7}},line:137}},branchMap:{"0":{loc:{start:{line:14,column:12},end:{line:18,column:13}},type:"if",locations:[{start:{line:14,column:12},end:{line:18,column:13}},{start:{line:14,column:12},end:{line:18,column:13}}],line:14},"1":{loc:{start:{line:26,column:12},end:{line:30,column:13}},type:"if",locations:[{start:{line:26,column:12},end:{line:30,column:13}},{start:{line:26,column:12},end:{line:30,column:13}}],line:26},"2":{loc:{start:{line:42,column:12},end:{line:55,column:13}},type:"if",locations:[{start:{line:42,column:12},end:{line:55,column:13}},{start:{line:42,column:12},end:{line:55,column:13}}],line:42},"3":{loc:{start:{line:46,column:20},end:{line:52,column:21}},type:"if",locations:[{start:{line:46,column:20},end:{line:52,column:21}},{start:{line:46,column:20},end:{line:52,column:21}}],line:46},"4":{loc:{start:{line:46,column:23},end:{line:50,column:51}},type:"binary-expr",locations:[{start:{line:46,column:23},end:{line:46,column:51}},{start:{line:47,column:26},end:{line:47,column:55}},{start:{line:48,column:26},end:{line:48,column:52}},{start:{line:49,column:26},end:{line:49,column:54}},{start:{line:50,column:26},end:{line:50,column:51}}],line:46},"5":{loc:{start:{line:71,column:12},end:{line:81,column:13}},type:"if",locations:[{start:{line:71,column:12},end:{line:81,column:13}},{start:{line:71,column:12},end:{line:81,column:13}}],line:71},"6":{loc:{start:{line:76,column:20},end:{line:79,column:21}},type:"if",locations:[{start:{line:76,column:20},end:{line:79,column:21}},{start:{line:76,column:20},end:{line:79,column:21}}],line:76},"7":{loc:{start:{line:96,column:12},end:{line:107,column:13}},type:"if",locations:[{start:{line:96,column:12},end:{line:107,column:13}},{start:{line:96,column:12},end:{line:107,column:13}}],line:96},"8":{loc:{start:{line:100,column:20},end:{line:105,column:21}},type:"if",locations:[{start:{line:100,column:20},end:{line:105,column:21}},{start:{line:100,column:20},end:{line:105,column:21}}],line:100},"9":{loc:{start:{line:120,column:4},end:{line:124,column:5}},type:"if",locations:[{start:{line:120,column:4},end:{line:124,column:5}},{start:{line:120,column:4},end:{line:124,column:5}}],line:120},"10":{loc:{start:{line:120,column:8},end:{line:120,column:27}},type:"binary-expr",locations:[{start:{line:120,column:8},end:{line:120,column:15}},{start:{line:120,column:19},end:{line:120,column:27}}],line:120},"11":{loc:{start:{line:138,column:8},end:{line:142,column:9}},type:"if",locations:[{start:{line:138,column:8},end:{line:142,column:9}},{start:{line:138,column:8},end:{line:142,column:9}}],line:138}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ca7520a3f5061baaa0eca8182b319b108c67d013"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_la3h57dik=function(){return actualCoverage;};}return actualCoverage;}cov_la3h57dik();const Event=(cov_la3h57dik().s[0]++,require("../models/event")),Group=(cov_la3h57dik().s[1]++,require("../models/group")),User=(cov_la3h57dik().s[2]++,require("../models/user")),Notification=(cov_la3h57dik().s[3]++,require("../models/notification"));const path=(cov_la3h57dik().s[4]++,require('path'));// all the helper functions go here
let helperObj=(cov_la3h57dik().s[5]++,{});cov_la3h57dik().s[6]++;helperObj.getAllUsers=function(groupID){cov_la3h57dik().f[0]++;cov_la3h57dik().s[7]++;return new Promise((resolve,reject)=>{cov_la3h57dik().f[1]++;cov_la3h57dik().s[8]++;Group.findById(groupID).populate("users").exec((err,group)=>{cov_la3h57dik().f[2]++;cov_la3h57dik().s[9]++;if(err){cov_la3h57dik().b[0][0]++;cov_la3h57dik().s[10]++;return reject(err);}else{cov_la3h57dik().b[0][1]++;cov_la3h57dik().s[11]++;resolve(group.users.map(user=>{cov_la3h57dik().f[3]++;cov_la3h57dik().s[12]++;return user._id;}));}});});};cov_la3h57dik().s[13]++;helperObj.getAllPending=function(groupID){cov_la3h57dik().f[4]++;cov_la3h57dik().s[14]++;return new Promise((resolve,reject)=>{cov_la3h57dik().f[5]++;cov_la3h57dik().s[15]++;Group.findById(groupID).populate("pending").exec((err,group)=>{cov_la3h57dik().f[6]++;cov_la3h57dik().s[16]++;if(err){cov_la3h57dik().b[1][0]++;cov_la3h57dik().s[17]++;return reject(err);}else{cov_la3h57dik().b[1][1]++;cov_la3h57dik().s[18]++;resolve(group.pending.map(user=>{cov_la3h57dik().f[7]++;cov_la3h57dik().s[19]++;return user._id;}));}});});};// Returns array of group IDs that user is part of
cov_la3h57dik().s[20]++;helperObj.getGroupIDs=function(userID){cov_la3h57dik().f[8]++;cov_la3h57dik().s[21]++;// Go through all groups' pending 
// If userID exists inside, store the group ID 
return new Promise((resolve,reject)=>{cov_la3h57dik().f[9]++;let id=(cov_la3h57dik().s[22]++,[]);cov_la3h57dik().s[23]++;Group.find({},{pending:1,rejected:1,users:1,removed:1,left:1},(err,result)=>{cov_la3h57dik().f[10]++;cov_la3h57dik().s[24]++;if(err){cov_la3h57dik().b[2][0]++;cov_la3h57dik().s[25]++;reject(err);}else{cov_la3h57dik().b[2][1]++;cov_la3h57dik().s[26]++;for(const res of result){cov_la3h57dik().s[27]++;if((cov_la3h57dik().b[4][0]++,res.pending.includes(userID))||(cov_la3h57dik().b[4][1]++,res.rejected.includes(userID))||(cov_la3h57dik().b[4][2]++,res.users.includes(userID))||(cov_la3h57dik().b[4][3]++,res.removed.includes(userID))||(cov_la3h57dik().b[4][4]++,res.left.includes(userID))){cov_la3h57dik().b[3][0]++;cov_la3h57dik().s[28]++;id.push(res._id);}else{cov_la3h57dik().b[3][1]++;}}cov_la3h57dik().s[29]++;resolve(id);}});});};cov_la3h57dik().s[30]++;helperObj.createObject=function(groupID,eventID){cov_la3h57dik().f[11]++;let obj=(cov_la3h57dik().s[31]++,{});cov_la3h57dik().s[32]++;obj.group=groupID;cov_la3h57dik().s[33]++;obj.event=eventID;cov_la3h57dik().s[34]++;return obj;};cov_la3h57dik().s[35]++;helperObj.getEvent=function(groupID){cov_la3h57dik().f[12]++;cov_la3h57dik().s[36]++;return new Promise((resolve,reject)=>{cov_la3h57dik().f[13]++;cov_la3h57dik().s[37]++;Event.find({},{groups:1},(err,result)=>{cov_la3h57dik().f[14]++;cov_la3h57dik().s[38]++;if(err){cov_la3h57dik().b[5][0]++;cov_la3h57dik().s[39]++;reject(err);}else{cov_la3h57dik().b[5][1]++;cov_la3h57dik().s[40]++;for(const res of result){const eventid=(cov_la3h57dik().s[41]++,res._id);cov_la3h57dik().s[42]++;if(res.groups.includes(groupID)){cov_la3h57dik().b[6][0]++;const newObj=(cov_la3h57dik().s[43]++,helperObj.createObject(groupID,eventid));cov_la3h57dik().s[44]++;resolve(newObj);}else{cov_la3h57dik().b[6][1]++;}}}});});};cov_la3h57dik().s[45]++;helperObj.changeObject=function(obj,group,event){cov_la3h57dik().f[15]++;cov_la3h57dik().s[46]++;obj.group=group;cov_la3h57dik().s[47]++;obj.event=event;cov_la3h57dik().s[48]++;return obj;};cov_la3h57dik().s[49]++;helperObj.getGroupAndEvent=function(obj){cov_la3h57dik().f[16]++;cov_la3h57dik().s[50]++;return new Promise((resolve,reject)=>{cov_la3h57dik().f[17]++;cov_la3h57dik().s[51]++;Group.findById(obj.group,(err,foundGroup)=>{cov_la3h57dik().f[18]++;cov_la3h57dik().s[52]++;if(err){cov_la3h57dik().b[7][0]++;cov_la3h57dik().s[53]++;reject(err);}else{cov_la3h57dik().b[7][1]++;cov_la3h57dik().s[54]++;Event.findById(obj.event,(err,foundEvent)=>{cov_la3h57dik().f[19]++;cov_la3h57dik().s[55]++;if(err){cov_la3h57dik().b[8][0]++;cov_la3h57dik().s[56]++;reject(err);}else{cov_la3h57dik().b[8][1]++;const newObj=(cov_la3h57dik().s[57]++,helperObj.changeObject(obj,foundGroup,foundEvent));cov_la3h57dik().s[58]++;resolve(newObj);}});}});});};cov_la3h57dik().s[59]++;helperObj.checkFileType=function(file,cb){cov_la3h57dik().f[20]++;// Check extension AND mimetype (because files are easily renameable)
// Allowed extensions 
const fileTypes=(cov_la3h57dik().s[60]++,/jpeg|jpg|png|gif/);// Check extensions
const extname=(cov_la3h57dik().s[61]++,fileTypes.test(path.extname(file.originalname.toLowerCase())));// Check mimetype
const mimetype=(cov_la3h57dik().s[62]++,fileTypes.test(file.mimetype));cov_la3h57dik().s[63]++;if((cov_la3h57dik().b[10][0]++,extname)&&(cov_la3h57dik().b[10][1]++,mimetype)){cov_la3h57dik().b[9][0]++;cov_la3h57dik().s[64]++;return cb(null,true);}else{cov_la3h57dik().b[9][1]++;cov_la3h57dik().s[65]++;return cb('Error: Images only');}};cov_la3h57dik().s[66]++;helperObj.escapeRegex=function(text){cov_la3h57dik().f[21]++;cov_la3h57dik().s[67]++;return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");};cov_la3h57dik().s[68]++;helperObj.checkBookmarks=function(event,userID){cov_la3h57dik().f[22]++;cov_la3h57dik().s[69]++;return event.bookmarks.includes(userID);};cov_la3h57dik().s[70]++;helperObj.getNotif=function(notifID){cov_la3h57dik().f[23]++;cov_la3h57dik().s[71]++;return new Promise((resolve,reject)=>{cov_la3h57dik().f[24]++;cov_la3h57dik().s[72]++;Notification.findById(notifID).populate("event").populate("group").exec((err,notif)=>{cov_la3h57dik().f[25]++;cov_la3h57dik().s[73]++;if(err){cov_la3h57dik().b[11][0]++;cov_la3h57dik().s[74]++;reject(err);}else{cov_la3h57dik().b[11][1]++;cov_la3h57dik().s[75]++;resolve(notif);}});});};cov_la3h57dik().s[76]++;module.exports=helperObj;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkV2ZW50IiwicmVxdWlyZSIsIkdyb3VwIiwiVXNlciIsIk5vdGlmaWNhdGlvbiIsInBhdGgiLCJoZWxwZXJPYmoiLCJnZXRBbGxVc2VycyIsImdyb3VwSUQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZpbmRCeUlkIiwicG9wdWxhdGUiLCJleGVjIiwiZXJyIiwiZ3JvdXAiLCJ1c2VycyIsIm1hcCIsInVzZXIiLCJfaWQiLCJnZXRBbGxQZW5kaW5nIiwicGVuZGluZyIsImdldEdyb3VwSURzIiwidXNlcklEIiwiaWQiLCJmaW5kIiwicmVqZWN0ZWQiLCJyZW1vdmVkIiwibGVmdCIsInJlc3VsdCIsInJlcyIsImluY2x1ZGVzIiwicHVzaCIsImNyZWF0ZU9iamVjdCIsImV2ZW50SUQiLCJvYmoiLCJldmVudCIsImdldEV2ZW50IiwiZ3JvdXBzIiwiZXZlbnRpZCIsIm5ld09iaiIsImNoYW5nZU9iamVjdCIsImdldEdyb3VwQW5kRXZlbnQiLCJmb3VuZEdyb3VwIiwiZm91bmRFdmVudCIsImNoZWNrRmlsZVR5cGUiLCJmaWxlIiwiY2IiLCJmaWxlVHlwZXMiLCJleHRuYW1lIiwidGVzdCIsIm9yaWdpbmFsbmFtZSIsInRvTG93ZXJDYXNlIiwibWltZXR5cGUiLCJlc2NhcGVSZWdleCIsInRleHQiLCJyZXBsYWNlIiwiY2hlY2tCb29rbWFya3MiLCJib29rbWFya3MiLCJnZXROb3RpZiIsIm5vdGlmSUQiLCJub3RpZiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJnN1hBZVk7eUZBZlosS0FBTUEsQ0FBQUEsS0FBSyx5QkFBR0MsT0FBTyxDQUFDLGlCQUFELENBQVYsQ0FBWCxDQUNNQyxLQUFLLHlCQUFHRCxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQURYLENBRU1FLElBQUkseUJBQUdGLE9BQU8sQ0FBQyxnQkFBRCxDQUFWLENBRlYsQ0FHTUcsWUFBWSx5QkFBR0gsT0FBTyxDQUFDLHdCQUFELENB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LEVBQWlEQSxRQUFqRCxDQUEwRCxPQUExRCxFQUFtRUMsSUFBbkUsQ0FBd0UsQ0FBQ0MsR0FBRCxDQUFNK0MsS0FBTixHQUFnQixpREFDeEYsR0FBSS9DLEdBQUosQ0FBUyxvREFDUEosTUFBTSxDQUFDSSxHQUFELENBQU4sQ0FDRCxDQUZELElBRU8sb0RBQ0xMLE9BQU8sQ0FBQ29ELEtBQUQsQ0FBUCxDQUNELENBQ0YsQ0FOQyxFQU9ILENBUk0sQ0FBUCxDQVNILENBVkQsQyx3QkFZQUMsTUFBTSxDQUFDQyxPQUFQLENBQWlCMUQsU0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBFdmVudCA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvZXZlbnRcIiksXG4gICAgICBHcm91cCA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvZ3JvdXBcIiksXG4gICAgICBVc2VyID0gcmVxdWlyZShcIi4uL21vZGVscy91c2VyXCIpLFxuICAgICAgTm90aWZpY2F0aW9uID0gcmVxdWlyZShcIi4uL21vZGVscy9ub3RpZmljYXRpb25cIilcblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKVxuXG4vLyBhbGwgdGhlIGhlbHBlciBmdW5jdGlvbnMgZ28gaGVyZVxubGV0IGhlbHBlck9iaiA9IHt9O1xuXG5oZWxwZXJPYmouZ2V0QWxsVXNlcnMgPSBmdW5jdGlvbihncm91cElEKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgR3JvdXAuZmluZEJ5SWQoZ3JvdXBJRCkucG9wdWxhdGUoXCJ1c2Vyc1wiKS5leGVjKChlcnIsIGdyb3VwKSA9PiB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZ3JvdXAudXNlcnMubWFwKCh1c2VyKSA9PiB1c2VyLl9pZCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn1cbiAgXG5oZWxwZXJPYmouZ2V0QWxsUGVuZGluZyA9IGZ1bmN0aW9uKGdyb3VwSUQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBHcm91cC5maW5kQnlJZChncm91cElEKS5wb3B1bGF0ZShcInBlbmRpbmdcIikuZXhlYygoZXJyLCBncm91cCkgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGdyb3VwLnBlbmRpbmcubWFwKCh1c2VyKSA9PiB1c2VyLl9pZCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuLy8gUmV0dXJucyBhcnJheSBvZiBncm91cCBJRHMgdGhhdCB1c2VyIGlzIHBhcnQgb2ZcbmhlbHBlck9iai5nZXRHcm91cElEcyA9IGZ1bmN0aW9uKHVzZXJJRCkge1xuICAgIC8vIEdvIHRocm91Z2ggYWxsIGdyb3VwcycgcGVuZGluZyBcbiAgICAvLyBJZiB1c2VySUQgZXhpc3RzIGluc2lkZSwgc3RvcmUgdGhlIGdyb3VwIElEIFxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCBpZCA9IFtdXG4gICAgICAgIEdyb3VwLmZpbmQoe30sIHtwZW5kaW5nOiAxLCByZWplY3RlZDogMSwgdXNlcnM6IDEsIHJlbW92ZWQ6IDEsIGxlZnQ6IDF9LCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGlmKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcmVzIG9mIHJlc3VsdCkgeyBcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzLnBlbmRpbmcuaW5jbHVkZXModXNlcklEKSBcbiAgICAgICAgICAgICAgICAgICAgICAgfHwgcmVzLnJlamVjdGVkLmluY2x1ZGVzKHVzZXJJRClcbiAgICAgICAgICAgICAgICAgICAgICAgfHwgcmVzLnVzZXJzLmluY2x1ZGVzKHVzZXJJRClcbiAgICAgICAgICAgICAgICAgICAgICAgfHwgcmVzLnJlbW92ZWQuaW5jbHVkZXModXNlcklEKVxuICAgICAgICAgICAgICAgICAgICAgICB8fCByZXMubGVmdC5pbmNsdWRlcyh1c2VySUQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQucHVzaChyZXMuX2lkKSBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXNvbHZlKGlkKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG59IFxuICBcblxuaGVscGVyT2JqLmNyZWF0ZU9iamVjdCA9IGZ1bmN0aW9uKGdyb3VwSUQsIGV2ZW50SUQpIHtcbiAgICBsZXQgb2JqID0ge31cbiAgICBvYmouZ3JvdXAgPSBncm91cElEXG4gICAgb2JqLmV2ZW50ID0gZXZlbnRJRCBcbiAgICByZXR1cm4gb2JqXG59XG5cbmhlbHBlck9iai5nZXRFdmVudCA9IGZ1bmN0aW9uKGdyb3VwSUQpIHsgXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgRXZlbnQuZmluZCh7fSwge2dyb3VwczogMX0sIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcmVzIG9mIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudGlkID0gcmVzLl9pZFxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZ3JvdXBzLmluY2x1ZGVzKGdyb3VwSUQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdPYmogPSBoZWxwZXJPYmouY3JlYXRlT2JqZWN0KGdyb3VwSUQsIGV2ZW50aWQpIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn1cbiAgXG4gIFxuaGVscGVyT2JqLmNoYW5nZU9iamVjdCA9IGZ1bmN0aW9uKG9iaiwgZ3JvdXAsIGV2ZW50KSB7XG4gICAgb2JqLmdyb3VwID0gZ3JvdXAgXG4gICAgb2JqLmV2ZW50ID0gZXZlbnQgXG4gICAgcmV0dXJuIG9ialxufVxuICBcbmhlbHBlck9iai5nZXRHcm91cEFuZEV2ZW50ID0gZnVuY3Rpb24ob2JqKSB7IFxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIEdyb3VwLmZpbmRCeUlkKG9iai5ncm91cCwgKGVyciwgZm91bmRHcm91cCkgPT4ge1xuICAgICAgICAgICAgaWYoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycilcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgRXZlbnQuZmluZEJ5SWQob2JqLmV2ZW50LCAoZXJyLCBmb3VuZEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3T2JqID0gaGVscGVyT2JqLmNoYW5nZU9iamVjdChvYmosIGZvdW5kR3JvdXAsIGZvdW5kRXZlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG5ld09iailcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuaGVscGVyT2JqLmNoZWNrRmlsZVR5cGUgPSBmdW5jdGlvbihmaWxlLCBjYikge1xuICAgIC8vIENoZWNrIGV4dGVuc2lvbiBBTkQgbWltZXR5cGUgKGJlY2F1c2UgZmlsZXMgYXJlIGVhc2lseSByZW5hbWVhYmxlKVxuICAgIC8vIEFsbG93ZWQgZXh0ZW5zaW9ucyBcbiAgICBjb25zdCBmaWxlVHlwZXMgPSAvanBlZ3xqcGd8cG5nfGdpZi9cbiAgICAvLyBDaGVjayBleHRlbnNpb25zXG4gICAgY29uc3QgZXh0bmFtZSA9IGZpbGVUeXBlcy50ZXN0KHBhdGguZXh0bmFtZShmaWxlLm9yaWdpbmFsbmFtZS50b0xvd2VyQ2FzZSgpKSlcbiAgICAvLyBDaGVjayBtaW1ldHlwZVxuICAgIGNvbnN0IG1pbWV0eXBlID0gZmlsZVR5cGVzLnRlc3QoZmlsZS5taW1ldHlwZSlcbiAgICBpZiAoZXh0bmFtZSAmJiBtaW1ldHlwZSkge1xuICAgICAgICByZXR1cm4gY2IobnVsbCwgdHJ1ZSlcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY2IoJ0Vycm9yOiBJbWFnZXMgb25seScpXG4gICAgfVxufVxuXG5oZWxwZXJPYmouZXNjYXBlUmVnZXggPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQucmVwbGFjZSgvWy1bXFxde30oKSorPy4sXFxcXF4kfCNcXHNdL2csIFwiXFxcXCQmXCIpO1xufVxuXG5oZWxwZXJPYmouY2hlY2tCb29rbWFya3MgPSBmdW5jdGlvbihldmVudCwgdXNlcklEKSB7XG4gICAgcmV0dXJuIGV2ZW50LmJvb2ttYXJrcy5pbmNsdWRlcyh1c2VySUQpXG59XG5cbmhlbHBlck9iai5nZXROb3RpZiA9IGZ1bmN0aW9uKG5vdGlmSUQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBOb3RpZmljYXRpb24uZmluZEJ5SWQobm90aWZJRCkucG9wdWxhdGUoXCJldmVudFwiKS5wb3B1bGF0ZShcImdyb3VwXCIpLmV4ZWMoKGVyciwgbm90aWYpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJlamVjdChlcnIpXG4gICAgICAgIH0gZWxzZSB7ICAgICAgXG4gICAgICAgICAgcmVzb2x2ZShub3RpZilcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGhlbHBlck9iajsiXX0=