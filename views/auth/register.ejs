<%- include("../partials/header")%>

  <div class="container">
    <h1 class="display-4 mb-3">Sign up</h1>
    
    <form action="/register" method="post" style="width: 500px;" enctype="multipart/form-data">
      <div class="form-group">
        <label>Your full name:</label>
        <% if (typeof data.name == 'undefined') {%>
        <input class="form-control" type="text" name="name" placeholder="Full name" required>
        <% } else { %>
          <input class="form-control" type="text" name="name" value="<%= data.name%>" required>
        <% } %>
      </div>
      <div class="form-group">
        <label>Your email:</label>
        <% if (typeof data.email == 'undefined') {%>
          <input class="form-control" type="email" name="email" placeholder="Your email" required>
        <% } else { %>
          <input class="form-control" type="text" name="email" value="<%= data.email%>" required>
        <% } %>
      </div>
      <div class="form-group">
        <label>Pick a username:</label>
        <% if (typeof data.username == 'undefined') {%>
        <input class="form-control" type="text" name="username" placeholder="Your username" required>
        <% } else { %>
          <input class="form-control" type="text" name="username" value="<%= data.username%>" required>
        <% } %>
      </div>
      <div class="form-group">
        <label>Enter a password:</label>
        <input class="form-control" type="password" id="password" name="password" minlength="8" required>
        <meter id="passwordMeter" max="4"></meter>
        <p id="strengthText"></p>
      </div>
      <div class="form-group">
        <label>Confirm your password:</label>
        <input class="form-control" type="password" name="passwordConfirm" id="passwordConfirmation" onkeyup="check()" required>
        <p id='confirmText'></p>
      </div>
      <div class="form-group">
        <label>Your organization:</label>
        <% if (typeof data.organization == 'undefined') {%>
          <input class="form-control" type="text" name="organization" placeholder="Organization" required>
        <% } else { %>
          <input class="form-control" type="text" name="organization" value="<%= data.organization%>" required>
        <% } %>
      </div>
      <div class="form-group">
        <label>Profile pic (Optional):</label>
        <h6 class="text-primary mb-2" style="font-size: 0.8rem;"><em>Please choose only .jpg, .jpeg and .png image files of size 1.0MB.</em></h6>
        <input type="file" class="form-control-file" name="file">
      </div>
      <button id="submit" class="btn btn-success mb-5">Register!</button
    </form>
    <script>
      const passwordField = document.getElementById('password')
      const passwordConfirm = document.getElementById('passwordConfirmation')
      const confirmText = document.getElementById('confirmText')
      const register = document.getElementById('submit')
      function check() {
        if (passwordField.value && passwordField.value ==
          passwordConfirm.value) {
          confirmText.style.color = 'green';
          confirmText.innerHTML = 'Passwords match!';
          register.disabled = false
        } else {
          confirmText.style.color = 'red';
          confirmText.innerHTML = 'Password does not match.';
          register.disabled = true
        }
    }
    const meterField = document.getElementById("passwordMeter")
    const strengthText = document.getElementById("strengthText")
    let strength = {
      0: "Very weak",
      1: "Weak",
      2: "Medium",
      3: "Good",
      4: "Strong"
    }
    meterField.style.display = 'none'
    passwordField.addEventListener('input', () => {
      let value = passwordField.value
      let checkResult = zxcvbn(value)
      meterField.style.display = 'block'
      meterField.value = checkResult.score
      if (value !== "") {
        strengthText.innerHTML = "Password strength: " + strength[checkResult.score]
      } else {
        strengthText.innerHTML = ""
      }
    }) 
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.2.0/zxcvbn.js"></script>
  </div>

<%- include("../partials/footer")%>
