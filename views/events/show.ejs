<%- include("../partials/header") %>

  <div class="container">
    <div class="jumbotron">
      <div class="container">
        <h1 class="mb-4 display-3">
          <%= event.name%>
          <div>
            <a class="btn btn-info ml-3" href="<%= event.url%>" target="_blank">
              See details
            </a>
            <a class="btn btn-success" href="/events/<%= event._id%>/edit">
              Edit this event
            </a>
          </div>
        </h1>
  
      </div>
    </div>
  
    <div class="container">
      <h2>General Information:</h2>
      <table class="table table-bordered col-lg-6">
        <tr>
          <th scope="col">Minimum group size</th>
          <th scope="col"><%= event.minGroupSize%></th>
        </tr>
        <tr>
          <th scope="col">Maximum group size</th>
          <th scope="col"><%= event.maxGroupSize%></th>
        </tr>
      </table>
    </div>
  
     <div class="container mt-5 mb-5">
       <h2>Current groups:</h2>
       <% if(event.groups.length == 0) { %>
         <h4 class="mt-3">There are currently no groups for this event.</h4>
       <% } else { %>
         <% event.groups.forEach((group) => { %>
          <% if (!(group.isClosed)) { %>
           <div class="card mt-3" style="width: 18rem;">
             <div class="card-body">
               <h5 class="card-title"><%= group.name%></h5>
               <p class="card-text"><%= group.description%></p>
               <% if(group.users.length >= event.maxGroupSize){ %>
                <p class="card-text text-danger">This group is full</p>
               <% } else { %>
                <p class="card-text">Current group size: <%= group.users.length%></p>
               <% } %>
               <a href="/events/<%= event._id%>/groups/<%= group._id%>">See group details</a>
             </div>
           </div>
          <% } %>
       <% })%>
       <% } %>
     <div>
      <% if (!(allUsers.includes(String(currentUser._id))) && !(allPending.includes(String(currentUser._id)))) { %>
        <a class="btn btn-primary mt-3" href="/events/<%= event._id%>/groups/new">Add a group</a>
      <% } %>
     </div>
   </div>
  </div>

<%- include("../partials/footer") %>
