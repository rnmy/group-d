<%- include("../partials/header") %>
<div class="container">
  <h1 class="display-4 pt-5">You are viewing: <strong><%= group.name%></strong></h1>
  <h6><%=group.description%></h6>
  <hr>
  <div class="row">
    <div class="col-md-9">
      <h3 class="mb-4">Current members:</h3>
      <% if (users.includes(currentUser._id)) { %>
        <h6 class="text-secondary mt-4 mb-4">You are currently a member of <%= group.name%></h6>
        <% } %>
      <% group.users.forEach((user) => { %>
        <div class="row">
          <div class="col-lg-6">
            <div class="card">
              <div class="card-body">
                <% if(String(user._id) == String(currentUser._id)) { %>
                  <h6 class="card-title">You</h6>
                <% } else { %>
                  <h6 class="card-title"><%= user.name%></h6>
                  <a href="/users/<%= user._id%>" class="card-text">Click to view full profile</a>
                <% } %>
              </div>
            </div>
          </div>
        </div>
        <% })%>
        <div class="container mt-5">
          <% if(!(group.size == event.maxGroupSize) && (!(users.includes(currentUser._id))) && (!(allUsers.includes(String(currentUser._id))))) { %>
            <form action="/events/<%= event._id%>/groups/<%= group._id%>?_method=PUT" method="post">
              <button class="btn btn-success mb-5">Join this group</button>
            </form>
            <% } %>
            <a class="btn btn-success" href="/events/<%= event._id%>">Go back to <%= event.name%></a>
            </div>
          </div>
          
          <% if(users.includes(currentUser._id)) { %>
            <div class="col-md-2 float-right text-center">
              <p class="lead"><strong>Settings</strong></p>
              <div class="list-group">
                <li class="list-group-item active">Group Page</li>
                <li class="list-group-item">Group Chat</li>
                <li class="list-group-item text-danger">Leave Group</li>
              </div>
            </div>
          <% } %>
        </div>
      </div>
<%- include("../partials/footer") %>
